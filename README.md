# koa2-wechat

基于koa2 使用co-wechat与co-wechat-api 快速搭建微信公众号<br>
下载项目 && cd koa2-wechat && npm install

# 使用ngrok进行外网映射

进行公众号开发是需要腾讯微信服务器能够访问到我们的服务器，所以要进行映射，推荐 ngrok，好用！<br>
https://ngrok.com/ 进行注册<br>
下载相应版本的客户端，根据网站提示一步一步来就可以了 <br>
进入目录后使用命令行 ./ngrok http 8080  打开映射 （端口号与项目中的保持一致即可） <br>

# 微信公众平台接口测试帐号申请

登录到测试帐号，将appid和appsecret配置到config.js中，将自定义的token填写到测试帐号<br>
运行项目 node server.js<br>
将ngrok映射的外网地址配置到测试帐号，完成配置<br>

# 小结

微信公众号的工作原理可以简单理解成，用户微信 <--> 腾讯微信公众号服务器 <--> 我们的服务器，三方间的数据传递。因此在开发中，为了让腾讯服务器可以访问到我们的本地服务器，则必须使用ngrok来进行映射，上面的步骤就是在完成我们的服务器与腾讯服务器间通信，其中appid,appsecret,token,服务器url即是配置参数。co-wechat完成的就是前面搭建通信的工作。<br>
在处理信息后调用微信业务接口的时候，需要事先获取一个access_token做验证，co-wechat-api完成的就是token的获取存储以及封装了一些微信业务接口供使用<br>
理解了这个思路，就可以很容易的完成微信公众号的搭建，剩下的任务也就是调用对应的微信业务接口与编写自己的业务代码。项目中只是简单完成了自动回复/自定义菜单/模板消息的搭建，注释也很清楚，希望可以帮到大家！